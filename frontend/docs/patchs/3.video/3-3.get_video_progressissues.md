# ISSUE REPORT — Phase 3-3 (Video Progress GET)

**Date**: 2026-01-16
**Author**: Amazing Korean Frontend Agent
**Scope**: `GET /videos/{id}/progress` (비디오 진도율 조회)

## 1. Summary
비디오 상세 페이지 진입 시 진도율을 조회하는 기능을 구현했으나, **로그 해석의 혼동**, **DTO 스펙 불일치**, **CSP 경고** 등의 이슈가 관찰됨. 기능 자체(GET 200)는 정상 작동함.

## 2. Issues & Resolutions

### 🔴 Issue 1: 초기 진입 시 401 Unauthorized 로그 발생
- **현상**: 페이지 진입 직후 콘솔과 네트워크 탭에 401 에러가 찍히고, 직후에 200 성공 로그가 찍힘.
- **원인**: 액세스 토큰이 만료된 상태에서 API를 호출함.
- **분석**:
    - 이는 에러가 아니라 **`Axios Interceptor`가 정상 작동하고 있다는 증거**임.
    - Flow: `Request (401)` -> `Interceptor Catch` -> `Refresh Token API` -> `Retry Request (200)`
- **조치**: **Working as Intended (정상 동작)**. 단, 개발자가 놀라지 않도록 문서에 "토큰 갱신 시 401 로그는 정상"임을 명시할 필요가 있음.

### 🟡 Issue 2: DB 저장 미작동 (데이터가 계속 0%)
- **현상**: 비디오를 시청했음에도 `progress_rate`가 갱신되지 않고 `video_log` 테이블에 데이터가 쌓이지 않음.
- **원인**: Phase 3-3은 **조회(GET)** 만을 다루는 단계였음. 저장(POST) 로직이 없어서 발생한 당연한 결과.
- **조치**: 다음 단계인 **Phase 3-4 (`POST /progress`)** 에서 `onPause`, `onEnded` 이벤트에 저장 로직을 구현하여 해결 예정.

### 🟡 Issue 3: DTO 스펙 불일치 & 기획 변경 (Resume Play)
- **현상**: 초기 기획(A안)에서는 "이어보기(Resume Play)"를 위해 `last_position_sec` 필드가 필요했으나, 백엔드 `types.ts` 및 DB 스키마에 해당 필드가 존재하지 않음.
- **분석**: 영상 길이가 대부분 10분 이내의 숏폼 형태이므로, 복잡한 이어보기 기능보다는 처음부터 재생하되 "완료 여부"만 보여주는 것이 효율적임.
- **조치**: **Spec Change**. 이어보기 기능을 스펙에서 제외하고, `VideoProgressRes` 타입(`video_id`, `progress_rate`, `is_completed`)에 맞춰 구현을 단순화함.

### ⚪ Issue 4: Vimeo Player CSP & Passive Event 경고
- **현상**: 콘솔에 `Content Security Policy` (blob 이미지 로드 차단) 및 `scroll-blocking 'touchstart'` 경고 다수 발생.
- **원인**: Vimeo Player 라이브러리 내부에서 사용하는 리소스가 브라우저 보안 정책이나 최신 이벤트 리스너 규격과 일부 충돌함.
- **조치**:
    - 기능 동작에는 영향이 없으므로 **Low Priority**로 분류.
    - 추후 `vite.config.ts`나 `index.html`의 메타 태그에서 CSP 설정을 완화(`img-src data: blob: ...`)하는 것을 검토.

## 3. Action Items (Next Step)
- [ ] **Phase 3-4 구현**: `POST /videos/{id}/progress` 구현을 통해 실제 진도율 저장 로직 완성.
- [ ] **UI Feedback**: 데이터 로딩 성공 시 사용자에게 시각적 피드백(예: '완료됨' 뱃지)을 줄 수 있도록 컴포넌트 보완.