# PATCH REPORT â€” Phase 3-1 Video List Implementation Issues & Fixes

**SUMMARY**:
Phase 3-1 ì‘ì—… ì¤‘ ë°œìƒí•œ **Backend-Frontend ìŠ¤í™ ë¶ˆì¼ì¹˜**, **Shadcn ì˜ì¡´ì„± ëˆ„ë½**, **íƒ€ì… ì‹œìŠ¤í…œ ì¶©ëŒ(Zod vs Interface)**, **Runtime Error**ë¥¼ ë¶„ì„í•˜ê³  í•´ê²° ë°©ì•ˆì„ ì •ì˜í•©ë‹ˆë‹¤.

---

## 1. ğŸš¨ Critical Issues Log

### A. Type System Conflict (Zod vs Interface)
- **ì¦ìƒ**: `Module ... has no exported member 'VideoSummary'.`
- **ì›ì¸**: `types.ts`ëŠ” ê¸°ì¡´ì— **Zod Schema**ë¡œ ì •ì˜ë˜ì–´ ìˆì—ˆìœ¼ë‚˜, êµ¬í˜„ ì½”ë“œëŠ” ì¡´ì¬í•˜ì§€ ì•ŠëŠ” **Interface(`VideoSummary`)**ë¥¼ ì°¸ì¡°í•¨.
- **í•´ê²°**: ê¸°ì¡´ Zod íƒ€ì…ì„ ê±´ë“œë¦¬ì§€ ì•Šê³ , UI ì „ìš© **Interface(`VideoListItem`)**ë¥¼ íŒŒì¼ í•˜ë‹¨ì— ì¶”ê°€(Append)í•˜ì—¬ í˜¸í™˜ì„± í™•ë³´.

### B. Backend Data Mismatch (Field Names)
- **ì¦ìƒ**:
  - `Property 'items' does not exist...` (Frontend: `items` / Backend: `data`)
  - `Property 'total' does not exist...` (Frontend: `total` / Backend: `total_count`)
  - `Property 'page' does not exist...` (Frontend: `page` / Backend: `current_page`)
- **í•´ê²°**: ë°±ì—”ë“œ ì‹¤ì œ ì‘ë‹µ(`Snake Case`)ì„ ê·¸ëŒ€ë¡œ ë”°ë¥´ëŠ” ì¸í„°í˜ì´ìŠ¤ ì •ì˜ ë° ë§¤í•‘ ìˆ˜ì •.

### C. Missing UI Fields & Null Safety
- **ì¦ìƒ**:
  - `Uncaught TypeError: Cannot read properties of undefined (reading 'toLocaleString')`
  - `v.video_title does not exist` (DB Error -> Frontend 500 Error)
- **ì›ì¸**:
  - FrontendëŠ” `description`, `view_count`, `uploader_name`ì„ ê¸°ëŒ€í–ˆìœ¼ë‚˜ Backend ì‘ë‹µì— ì—†ìŒ.
  - `meta.total_count`ê°€ `undefined`ì¼ ë•Œ ë°©ì–´ ì½”ë“œê°€ ì—†ì–´ ë Œë”ë§ í¬ë˜ì‹œ ë°œìƒ.
  - `title`, `thumbnail_url`ì´ `null`ì¼ ìˆ˜ ìˆìŒ.
- **í•´ê²°**:
  - `description` -> `subtitle`ë¡œ ëŒ€ì²´.
  - `duration`(String) -> `duration_seconds`(Number)ë¡œ ë³€ê²½ ë° í¬ë§·íŒ… í•¨ìˆ˜ ì¶”ê°€.
  - `view_count`, `uploader_name` ì œê±°.
  - `??` ì—°ì‚°ìë¥¼ ì‚¬ìš©í•œ Null Safety ê°•í™” (Defensive Coding).

### D. Missing Dependencies (Vite Build Error)
- **ì¦ìƒ**: `Failed to resolve import "@/components/ui/pagination"`, `aspect-ratio`
- **ì›ì¸**: Shadcn ì»´í¬ë„ŒíŠ¸ê°€ ì„¤ì¹˜ë˜ì§€ ì•Šì€ ìƒíƒœì—ì„œ import ì‹œë„.
- **í•´ê²°**: ì‘ì—… ì‹œì‘ ì „ `npx shadcn@latest add ...` ëª…ë ¹ì–´ ì‹¤í–‰ ê°•ì œ.

---

## 2. âœ… Final Resolution Plan (Instructions)

### Step 1. Type Definition Update (`src/category/video/types.ts`)
ê¸°ì¡´ Zod ì½”ë“œë¥¼ ìœ ì§€í•˜ë˜, ì•„ë˜ **Correct Interface**ë¥¼ íŒŒì¼ í•˜ë‹¨ì— ì¶”ê°€í•œë‹¤.

```typescript
// [Fix] UI Componentìš© Interface (Backend 1:1 ë§¤í•‘)
export interface VideoListItem {
  video_id: number;
  title: string | null;          // Nullable ì²˜ë¦¬ í•„ìˆ˜
  subtitle: string | null;       // description ëŒ€ì‹  ì‚¬ìš©
  thumbnail_url: string | null;  // Nullable ì²˜ë¦¬ í•„ìˆ˜
  video_url_vimeo: string;
  duration_seconds: number | null; // ì´ˆ ë‹¨ìœ„ ìˆ«ì
  created_at: string;
  language: string | null;
  has_captions: boolean;
}

export interface VideoListRes {
  data: VideoListItem[];         // items -> data
  meta: {
    total_count: number;         // total -> total_count
    current_page: number;        // page -> current_page
    per_page: number;
    total_pages: number;
  };
}

// ìš”ì²­ íƒ€ì…ì€ ê¸°ì¡´ ìœ ì§€ í˜¹ì€ ì•„ë˜ ì‚¬ìš©
export interface VideoListReq {
  page?: number;
  per_page?: number;
  sort?: string;
  lang?: string;
}
```

### Step 2. Component Logic Fix (`video_card.tsx`)
- `VideoSummary` ëŒ€ì‹  `VideoListItem` íƒ€ì… ì‚¬ìš©.
- **í¬ë§·íŒ…**: `duration_seconds`ë¥¼ `MM:SS` í˜•íƒœë¡œ ë³€í™˜í•˜ëŠ” ìœ í‹¸ í•¨ìˆ˜ ì¶”ê°€.
- **í•„ë“œ ë§¤í•‘**:
  - `description` ì‚­ì œ -> `subtitle` í‘œì‹œ.
  - `view_count` ì‚­ì œ -> `language` ë° `CC` ë°°ì§€ë¡œ ëŒ€ì²´.
- **Null ì²˜ë¦¬**: `title ?? "ì œëª© ì—†ìŒ"`, `thumbnail_url ?? "placeholder"`

### Step 3. Page Logic Fix (`video_list_page.tsx`)
- **ë°ì´í„° ì ‘ê·¼**: `data?.items` ê°€ ì•„ë‹Œ **`data?.data`** ì‚¬ìš©.
- **Meta ì ‘ê·¼**: `meta.total` ê°€ ì•„ë‹Œ **`meta.total_count`** ì‚¬ìš©.
- **Crash ë°©ì§€**: `(meta.total_count ?? 0).toLocaleString()` í˜•íƒœë¡œ ì‘ì„±.

### Step 4. Dependency Installation
- ì‹¤í–‰ ëª…ë ¹ì–´:
  ```bash
  npx shadcn@latest add aspect-ratio pagination skeleton card badge
  ```

---

## 3. Revised Output Checklist
ì´ ë¬¸ì„œë¥¼ ë°”íƒ•ìœ¼ë¡œ ì‘ì—…ì„ ìˆ˜í–‰í•  ì—ì´ì „íŠ¸ëŠ” ë‹¤ìŒ ì‚¬í•­ì„ ê²€ì¦í•´ì•¼ í•œë‹¤.
1.  [ ] `types.ts`ì— `VideoListItem`ì´ ì •í™•íˆ ì •ì˜ë˜ì—ˆëŠ”ê°€?
2.  [ ] `video_card.tsx`ì—ì„œ ì—†ëŠ” í•„ë“œ(`uploader_name` ë“±)ë¥¼ ì°¸ì¡°í•˜ì§€ ì•ŠëŠ”ê°€?
3.  [ ] `video_list_page.tsx`ì—ì„œ `data.data`ë¡œ ë°°ì—´ì— ì ‘ê·¼í•˜ëŠ”ê°€?
4.  [ ] `npm run dev` ì‹¤í–‰ ì‹œ Shadcn ì»´í¬ë„ŒíŠ¸ missing ì—ëŸ¬ê°€ ì—†ëŠ”ê°€?