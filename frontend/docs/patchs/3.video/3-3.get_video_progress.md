# PATCH REQUEST — FRONTEND Phase 3-3 (Video Progress GET)

**ROLE**:
- 당신은 **Amazing Korean API의 프론트엔드 전담 AI 에이전트**입니다.
- **Tech Stack**: React (Vite), TypeScript, Tailwind CSS, Shadcn/ui, TanStack Query.
- **AMK_API_MASTER.md**의 Phase 3-3 스펙을 준수합니다.

**OBJECTIVE**:
- **비디오 상세 페이지(`VideoDetailPage`)** 진입 시, 사용자의 학습 진도율(`progress_rate`)과 완료 여부(`is_completed`)를 조회합니다.
- **UX 정책**:
    - **No Resume Play**: 영상이 짧으므로(10분 이내) 자동 이어보기 기능은 구현하지 않습니다.
    - **Status Display**: 조회된 진도율 데이터는 콘솔에 로그를 출력하거나, 추후 UI 바인딩을 위해 데이터 로딩 상태만 확보해 둡니다.

**CONTEXT (State & Spec)**:
1.  **State Axis Compliance**:
    - **Auth**: `pass`(로그인 상태)일 때만 API를 호출하고, `stop`(비로그인)이면 호출하지 않습니다 (Enabled: false).
    - **Data**: `present`(기록 있음) 또는 `empty`(기록 없음) 상태를 처리합니다.
2.  **DTO Definition (`types.ts`)**:
    - 백엔드 DTO와 정확히 일치해야 합니다.
    - `video_id`: number
    - `progress_rate`: number (0~100)
    - `is_completed`: boolean
    - `last_watched_at`: string | null

**MCP ACTIONS (필수 수행)**:
작업 시작 전 다음 파일들을 읽고 컨텍스트를 확보하십시오.
1.  **Read Types**: `src/types.ts` (VideoProgressRes 타입 정의 확인)
2.  **Read Component**: `src/category/video/page/VideoDetailPage.tsx` (훅 연동 위치 파악)
3.  **Read API Client**: `src/api/video.ts` (기존 비디오 API 파일 확인)

**IMPLEMENTATION STEPS**:

1.  **Step 1. API Function (`src/api/video.ts`)**:
    - `getVideoProgress(videoId: string)` 함수를 추가하십시오.
    - **Return Type**: `VideoProgressRes` (types.ts에 정의된 타입 사용).

2.  **Step 2. Custom Hook (`src/category/video/hook/useVideoProgress.ts`)**:
    - React Query의 `useQuery`를 사용하여 데이터를 관리하는 훅을 작성하십시오.
    - **Query Key**: `['video-progress', videoId]`
    - **Options**:
        - `enabled`: `!!videoId && isLoggedIn` (비로그인 시 호출 방지, `useAuthStore` 활용)
        - `retry`: 1
        - `staleTime`: 0 (항상 최신 상태 조회)

3.  **Step 3. UI Integration (`src/category/video/page/VideoDetailPage.tsx`)**:
    - `useVideoProgress` 훅을 컴포넌트 상단에 호출하십시오.
    - **Validation**: 데이터 로딩 성공 시, 콘솔에 `[VideoProgress] Loaded: { progress_rate: ..., is_completed: ... }`를 출력하여 연동을 확인하십시오.
    - (Optional): 만약 `is_completed`가 `true`라면 비디오 플레이어 하단이나 타이틀 옆에 "완료됨(Completed)" 텍스트나 배지를 임시로 표시해 주셔도 좋습니다.

**PATCH RULES (Iron Rules)**:
1.  **Strict Type Safety**: `types.ts`에 정의된 `VideoProgressRes` 외에 임의의 필드(`last_position_sec` 등)를 사용하지 마십시오.
2.  **Silent Fail**: API가 404를 리턴하거나 실패해도, 사용자에게 에러 모달을 띄우지 말고 조용히(Log only) 넘어가십시오. 비디오 재생 자체를 막으면 안 됩니다.
3.  **Separation**: 비디오 재생 로직(Vimeo Player)과 진도율 조회 로직(Query)을 섞지 마십시오. Player는 Player대로 동작해야 합니다.