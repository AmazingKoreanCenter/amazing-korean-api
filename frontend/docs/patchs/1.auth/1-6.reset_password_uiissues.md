# 🛠️ Issue Log: Phase 1-6 (Reset Password UI) Implementation

## 📋 개요
- **작업**: 비밀번호 재설정 페이지(`/reset-password`) 구현 및 토큰 기반 진입 로직 검증.
- **기간**: 2026.01.13
- **주요 성과**:
  - **URL Token Extraction**: `useSearchParams`를 통해 이메일 링크의 토큰 파싱 로직 구현.
  - **Security Flow**: 토큰 누락 시 접근 차단(Redirect) 및 유효하지 않은 토큰에 대한 401 에러 핸들링 검증.
  - **Conditional UI**: 인증 상태(로그인 여부)에 따른 메인 화면 버튼(로그인 vs 로그아웃) 동적 렌더링 구현.

---

## 🐛 발생 이슈 및 해결 (Troubleshooting)

### 1. 포트 충돌 (EADDRINUSE: 5173)
- **현상**: `npm run dev` 실행 시 5173 포트가 이미 사용 중이라며 5174 등 다른 포트로 실행됨. 백엔드 CORS 설정(5173 허용)과 불일치 발생 우려.
- **원인**: 이전 실행 프로세스가 제대로 종료되지 않고 백그라운드(Zombie Process)에 남아 있었음.
- **해결**:
  - `sudo lsof -i :5173`으로 PID 식별 후 `kill -9 [PID]`로 강제 종료.
  - 또는 `npx kill-port 5173`으로 정리 후 재시작.

### 2. 페이지 진입 즉시 리다이렉트 (304 Not Modified & Redirect)
- **현상**: `/reset-password` 접속 시 화면이 안 뜨거나 바로 홈으로 튕김. 네트워크 탭엔 304 상태 코드만 찍힘.
- **원인**:
  - 304는 브라우저 캐시 동작(정상).
  - 실제 원인은 페이지 내의 **"토큰 검사 방어 로직"**. URL에 `?token=...`이 없으면 즉시 메인으로 쫓아내도록 구현되었기 때문.
- **해결**: 테스트 시 `?token=TEST_TOKEN`을 URL 뒤에 수동으로 붙여서 진입하여 폼 렌더링 확인.

### 3. TypeScript 타입 불일치 (StoredUser vs UI)
- **현상**: 메인 화면에서 로그인 사용자 이름을 표시하려 했으나, `Property 'nickname' does not exist on type 'StoredUser'` 에러 발생.
- **원인**: 프론트엔드의 `StoredUser` 타입 정의에는 `user_id`만 있고, 실제 UI에서 쓰려는 `nickname/name` 속성이 정의되어 있지 않음.
- **조치 (Hotfix)**:
  - 우선 기능 확인을 위해 `user.user_id`를 출력하도록 수정하여 테스트 통과.
  - 추후 `auth/types.ts`의 `LoginRes` 및 `StoredUser` 타입을 백엔드 응답 스키마에 맞춰 확장해야 함.

---

## 💡 Key Takeaways (교훈)
1.  **Testing Environment**: "이메일 링크 타고 들어오기" 같은 외부 진입 시나리오는 URL 쿼리 파라미터를 수동으로 조작하여 테스트해야 한다.
2.  **Type Safety**: 백엔드가 주는 데이터(JSON)와 프론트엔드가 알고 있는 타입(Interface