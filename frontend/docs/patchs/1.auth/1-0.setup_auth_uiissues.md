# 🛠️ Issue Log: Phase 1-0 (Setup Auth Infrastructure)

## 📋 개요
- **작업**: 인증(Auth) 기능 구현을 위한 전역 상태 관리(Store) 및 UI 기반 구축
- **기간**: 2026.01.12
- **주요 성과**:
  - **역할 분담 프로세스 정립**: 패키지 설치는 개발자가, 코드 구현은 AI가 전담하는 워크플로우 확립.
  - **Zustand Store 구축**: `persist` 미들웨어를 적용하여 새로고침 시에도 로그인 상태가 유지되도록 구현.
  - **UI 인프라 준비**: 회원가입/로그인에 필요한 Shadcn 컴포넌트 사전 설치 완료.

---

## 🐛 발생 이슈 및 해결 (Troubleshooting)

### 1. AI의 패키지 매니저 실행 리스크 관리
- **고민**: Codex에게 `npm install`이나 `npx shadcn add` 명령어 실행을 맡길 경우 발생할 수 있는 문제점(인터랙티브 입력 대기, 네트워크 타임아웃, 버전 충돌) 우려.
- **결정**: **Role Separation (역할 분리)** 원칙 도입.
  - **User (개발자)**: 터미널 제어권 보유. 패키지 설치 및 환경 설정 수행.
  - **AI (Codex)**: 소스 코드 작성 및 수정 전담. "Dependencies are installed"라는 전제 하에 로직 구현에 집중.
- **효과**: 설치 과정의 불확실성을 제거하고, AI는 순수 로직 구현에만 집중하여 결과물의 안정성 확보.

### 2. 로그인 상태의 영속성(Persistence) 처리
- **이슈**: 일반적인 Zustand 스토어는 메모리에 저장되므로, 브라우저 새로고침 시 로그인이 풀리는 현상 발생 예정.
- **해결**:
  - Zustand의 `persist` 미들웨어를 도입.
  - `name: 'auth-storage'` 옵션을 주어 `localStorage`에 토큰과 유저 정보가 자동 저장되도록 설정.
  - `Client` 사이드에서 초기화될 때 스토리지 값을 불러오도록 처리.

### 3. 백엔드 DTO와 프론트엔드 Store의 타입 불일치 방지
- **이슈**: Store 내부의 `user` 객체 타입을 임의로 정의할 경우, 실제 백엔드 응답(`LoginRes`)과 달라질 위험 존재.
- **해결**:
  - Phase 0에서 변환해둔 `src/category/user/types.ts`의 `UserResponse` 등을 직접 import하여 사용.
  - Store의 `login()` 액션 파라미터 타입을 `LoginRes | SignupRes`로 강제하여 타입 안전성 확보.

### 4. Toast 컴포넌트의 배치 전략
- **이슈**: 개별 페이지에서 Toast를 호출하려면 최상위 레이아웃에 Provider가 있어야 함.
- **해결**: `App.tsx` (또는 Root Layout) 최상단에 `<Toaster />` 컴포넌트를 배치하여, 앱 내 어디서든 `toast.success()` 등을 즉시 사용할 수 있도록 인프라 구성.

---

## 💡 Key Takeaways (교훈)
1.  **Infrastructure First**: 화면(UI)을 그리기 전에 상태 관리(Store)와 공통 컴포넌트(UI Kit)가 먼저 준비되어야 개발 속도가 빨라진다.
2.  **DevOps by Human, Code by AI**: 시스템 환경에 영향을 주는 작업은 사람이 직접 하고, AI는 그 위에서 돌아가는 코드만 짜게 하는 것이 가장 안전한 협업 방식이다.