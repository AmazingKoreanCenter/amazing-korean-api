# 🛠️ Issue Log: Phase 2-1 (User Me UI) Implementation

## 📋 개요
- **작업**: 사용자 상세 정보 조회 페이지(`/user/me`) 구현 및 보안/네트워크 설정 강화.
- **기간**: 2026.01.13
- **주요 성과**:
  - **Secure Routing**: `PrivateRoute`를 도입하여 비로그인 사용자의 접근을 원천 차단.
  - **Dev Environment**: `vite.config.ts` 프록시 설정을 최적화하여 API 요청 라우팅 문제 해결.
  - **Refactoring**: `routes.tsx`와 `HomePage` 분리, 개발자 전용 네비게이션(Dev Map) 구축.

---

## 🐛 발생 이슈 및 해결 (Troubleshooting)

### 1. API 요청 시 HTML 응답 반환 (The "index.html" Response)
- **현상**: `/users/me` API 호출 시 JSON 데이터 대신 `<!doctype html>...` (index.html) 코드가 반환됨.
- **원인**:
  - Vite 개발 서버는 기본적으로 SPA(Single Page Application) 라우팅을 처리함.
  - `/users` 경로에 대한 프록시 설정이 없어서, Vite가 이를 "페이지 이동 요청"으로 오인하고 `index.html`을 서빙함.
- **해결**:
  - `vite.config.ts`의 `server.proxy` 섹션에 `/users` 및 `/auth` 경로를 추가.
  - 해당 요청들이 프론트엔드 서버를 거쳐 백엔드(`http://127.0.0.1:8000`)로 정확히 전달되도록 설정.

### 2. 비로그인 유저의 페이지 접근 (Access Control)
- **현상**: 로그아웃 상태에서 URL로 `/user/me`에 직접 접근 시, 빈 화면이나 에러가 발생함.
- **해결**:
  - **Route Guard (`PrivateRoute`) 구현**: `useAuthStore`의 유저 정보 유무를 확인.
  - 정보가 없으면 `<Navigate to="/login" replace />`를 통해 즉시 로그인 페이지로 강제 리다이렉트.

### 3. 401 Unauthorized 및 304 Not Modified
- **현상**:
  - 프록시 설정 변경 및 서버 재시작 후 API 호출 시 `401` 에러 발생.
  - 정상 호출 시 `200 OK`가 아닌 `304`가 떠서 오류로 오해.
- **원인 & 조치**:
  - **401**: 서버 재시작으로 인해 세션/설정이 변경되었으나, 클라이언트는 구버전 토큰을 사용 중이었음 -> **로그아웃 후 재로그인**으로 해결.
  - **304**: 브라우저 캐시 적중(Cache Hit) 신호로, 데이터 변경이 없어 트래픽을 아꼈다는 뜻 -> **정상 동작**임을 확인.

### 4. 구조적 리팩토링 및 타입 이슈
- **현상**: `routes.tsx` 비대화 및 `user` 객체 타입 불일치.
- **해결**:
  - `HomePage` 컴포넌트 분리.
  - `UserDetail` 인터페이스 정의로 타입 안정성 확보.

---

## 💡 Key Takeaways (교훈)
1.  **Vite Proxy is Essential**: 프론트엔드 개발 서버에서 백엔드로 요청을 보낼 때는, 반드시 `vite.config.ts`에 해당 API 경로(`/users`, `/auth`)에 대한 **프록시 타겟**을 명시해야 한다.
2.  **Restart after Config**: 설정 파일(`vite.config.ts`, `.env`)을 수정하면 반드시 개발 서버를 **재시작(Kill & Run)** 해야 적용된다.
3.  **Token Refresh**: 개발 중 서버 설정이 바뀌거나 꼬였을 때 발생하는 401 에러는, 대부분 **로그아웃/로그인**을 통해 토큰을 새로 발급받으면 해결된다.