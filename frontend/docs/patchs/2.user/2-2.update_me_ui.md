# PATCH REQUEST — FRONTEND Phase 2-2 Update User UI

**ROLE**:
- Frontend Developer (React, React Hook Form, Zod, React Query).

**OBJECTIVE**:
- 로그인한 사용자의 정보를 수정하는 페이지(`/user/edit`)를 구현하시오.
- `POST /users/me` 엔드포인트를 사용하여 데이터를 전송하고, 성공 시 변경된 정보를 즉시 반영(Invalidate Query)해야 합니다.

**MCP ACTIONS**:
1.  **Read Types**: `src/category/user/types.ts` 확인 (없다면 `UpdateUserReq` 추가).
2.  **Read API**: `src/category/user/user_api.ts` 확인.

**UI SPEC (Shadcn First)**:
- **Path**: `/user/edit` (Protected Route)
- **Layout**: `max-w-lg` 중앙 정렬 Card.
- **Components**:
    - `<Form>`: React Hook Form + Zod Resolver.
    - **Fields**:
        - `nickname`: 수정 가능 (중복 시 409 에러 처리).
        - `name`: 수정 가능.
        - `email`: 읽기 전용 (Disabled) - 이메일 변경은 별도 인증 필요하므로 여기선 제외.
        - `bio` (자기소개): Textarea (선택 사항).
    - **Buttons**:
        - "저장하기" (Submitting state).
        - "취소" (이전 페이지로 이동).
- **Feedback**:
    - **Pre-fill**: 진입 시 `useUserMe` 데이터를 폼에 미리 채워둠.
    - **Success (200)**: Toast "정보가 수정되었습니다" -> `/user/me`로 이동.
    - **Conflict (409)**: "이미 사용 중인 닉네임입니다." (Form Field Error).
    - **Validation (400/422)**: Zod 검증 에러 표시.

**DATA SPEC**:
- **API Endpoint**: `POST /users/me` (Note: Partial Update)
- **Request Body (`UpdateUserReq`)**:
  ```typescript
  {
    nickname?: string;
    name?: string;
    bio?: string;
    // 필요한 경우 profile_image_url 등 추가
  }
  ```
- **React Query Flow**:
    - Mutation 성공(`onSuccess`) 시 `queryClient.invalidateQueries({ queryKey: ['user', 'me'] })` 필수 호출.

**IMPLEMENTATION STEPS**:
1.  **Type**: `src/category/user/types.ts` -> `UpdateUserReq` 정의.
2.  **API**: `src/category/user/user_api.ts` -> `updateUserMe` 함수 추가.
3.  **Hook**: `src/category/user/hook/use_update_user.ts` -> `useMutation` 구현.
4.  **Component**: `src/category/user/page/edit_profile_page.tsx` 구현.
    - `useUserMe`로 데이터 로딩 -> `useEffect`로 `form.reset(data)` 하여 초기값 설정.
5.  **Route**: `src/app/routes.tsx` -> `/user/edit` 등록 (PrivateRoute 내부).

**FILE PATCHES**:
// src/category/user/types.ts
// src/category/user/user_api.ts
// src/category/user/hook/use_update_user.ts
// src/category/user/page/edit_profile_page.tsx
// src/app/routes.tsx

**PATCH RULES**:
1.  **Conflict Handling**: `409` 에러 응답 시, `form.setError('nickname', ...)`를 사용하여 사용자에게 명확히 알려줄 것.
2.  **State Sync**: 수정 성공 후 사용자가 '내 정보' 페이지로 돌아갔을 때, 반드시 바뀐 정보가 보여야 함 (Query Invalidation).