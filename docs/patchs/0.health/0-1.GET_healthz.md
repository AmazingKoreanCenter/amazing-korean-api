# PATCH — Phase 0-1 Health Check (GET /healthz)

ROLE: Senior Rust Backend (Axum 0.8, SQLx 0.7+, utoipa 5, Rust stable 1.89)를 돕는 **AI 코딩 에이전트**

OBJECTIVE:
- 기존에 작성된 `src/api/health` 모듈을 점검하고, AMK_API_MASTER.md의 **점검사항(시나리오)**을 완벽히 충족하도록 수정/보완.
- 단순 200 OK 반환을 넘어, JSON 응답 구조와 에러 처리를 스펙에 맞춤.

CONTEXT (프로젝트 규칙 - SSOT 준수):
- **Spec**: `docs/AMK_API_MASTER.md`의 [5.0 Phase 0] 및 [0-1 시나리오] 참조.
- **Scenarios (점검사항 필수 반영)**:
  1. **성공 (200 OK)**:
     - 상태: Auth pass / Page ready / Request success / Data present
     - 응답: `200 OK`, JSON `{"status": "live", "uptime_ms": ..., "version": "..."}`
  2. **실패 (500 Internal Server Error)**:
     - 상태: Auth pass / Request error / Data error
     - 상황: 서버 내부 로직(DB 연결 등) 실패 시
     - 응답: `500 Error`, JSON `{"error": {"http_status": 500, "code": "HEALTH_INTERNAL", ...}}`

CONTRACT (구현 명세):
- [Phase] Phase 0-1 라이브 헬스 (Healthz)
- [HTTP] GET /healthz
- [Logic]
  - 별도의 인증 절차 없이 접근 가능해야 함 (Auth pass).
  - 시스템 업타임(uptime) 등을 계산하여 반환.
  - (선택) DB 연결 상태 등을 체크하여 문제 발생 시 500 에러 반환 로직 포함(또는 확장 가능성 열어둠).
- [Response] `HealthRes` DTO 사용 (status, version 등 포함).

PATCH RULES (엄격 준수):
1. **Full File Replacement**: `src/api/health/handler.rs`, `src/api/health/dto.rs` 등 수정되는 파일은 **전체 코드**를 제공할 것.
2. **Compile-Ready**: `cargo check` 통과 필수.
3. **Smoke Test**: 성공 케이스(200)와 실패 케이스(가정)를 검증할 수 있는 cURL 명령어를 포함할 것.

ACCEPTANCE CRITERIA:
- `cargo check` 통과 ✔
- `GET /healthz` 호출 시 200 OK 및 JSON 바디 반환 ✔
- Swagger UI (`/docs`) 태그 순서(`health`가 맨 앞) 확인 ✔

FILE PATCHES START
// AI가 기존 코드를 바탕으로 수정된 코드를 작성할 영역
FILE PATCHES END

# cURL SMOKE
```bash
# 1. 성공 케이스 테스트
curl -v http://localhost:3000/healthz

# 2. (참고) 실패 케이스는 서버 강제 에러 상황(예: DB 중단)에서 500이 나오는지 확인 필요
```