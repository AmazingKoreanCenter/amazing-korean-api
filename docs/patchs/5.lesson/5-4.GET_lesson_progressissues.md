# 📝 Phase 5-4 회고 및 트러블슈팅 로그

이번 Phase는 간단해 보이는 '조회' 기능 속에 숨겨진 **"에러와 빈 값(Empty State)의 의미론적 차이"**를 명확히 정의하는 과정이었습니다.

## 1. 아키텍처 및 로직 설계 (Architecture & Logic)

### ✅ '데이터 없음'의 처리 (Default Value vs 404)
* **고민:** "사용자가 아직 공부를 시작하지 않아서 기록이 없는 경우, 404 에러를 줘야 하는가?"
* **결정:** **200 OK + 기본값(0%)** 반환.
* **이유:** '진행도가 0인 상태'는 에러가 아니라 **정상적인 초기 상태**임. 클라이언트가 404 에러 핸들링을 하지 않고, 바로 UI(0% 바)를 그릴 수 있도록 DX(Developer Experience)를 최적화함.

### ✅ 404 Not Found의 엄격한 정의
* **로직:**
  1. `lesson_id`가 유효한지 먼저 검사 (`repo.exists_lesson`).
  2. 수업이 없으면 → **404 Not Found** (클라이언트가 잘못된 페이지 접근).
  3. 수업은 있는데 기록이 없으면 → **200 OK (0%)** (정상).
* **성과:** '없는 주소 접근'과 '데이터 없음'을 명확히 분리하여 API의 신뢰성 확보.

## 2. 보안 및 인증 (Security)

### ✅ 강제 인증 적용 (AuthGuard)
* **적용:** `AuthUser` 추출자를 사용하여 토큰이 없거나 만료된 경우 핸들러 진입 전에 **401 Unauthorized**를 리턴.
* **의의:** 개인화된 데이터(진행도)는 반드시 보안이 전제되어야 함을 코드 레벨에서 보장.

## 3. 테스트 전략 변경 (Strategy Pivot)
* **변경:** SQL을 이용한 더미 데이터 주입(Seeding) 대신, **Phase 5-5(진행도 갱신) 구현 후 E2E 테스트**로 전환.
* **이유:** 실제 비즈니스 로직(API)을 통해 데이터가 생성되고 조회되는 전체 사이클을 검증하는 것이 더 실효성 있다고 판단.

## 4. 총평 (Conclusion)
* **진행:** 에러 처리와 기본값 처리 정책이 확립되어, 클라이언트 연동 시 예외 처리가 대폭 간소화될 것으로 기대됨.