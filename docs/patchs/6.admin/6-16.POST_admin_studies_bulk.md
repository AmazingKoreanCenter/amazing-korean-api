# Phase 6-16 Admin Bulk Create Studies (POST /admin/studies/bulk)

ROLE: Senior Rust Backend AI Assistant

OBJECTIVE:
- `POST /admin/studies/bulk` 엔드포인트를 구현하여 학습 문제(Study)를 다중 생성합니다.
- **핵심 요구사항**: User/Video 모듈에서 사용했던 **"부분 성공(Partial Success - 207)"** 패턴을 반드시 재사용해야 합니다.
    - 전체를 하나의 트랜잭션으로 묶지 말고, **아이템마다 개별 트랜잭션**을 사용하여 하나가 실패해도 나머지는 성공하도록 구현하세요.

CONTEXT (SSOT & Rules):
1.  **참조 로직 (Reference Pattern)**:
    - `src/api/admin/video/service.rs`의 `admin_bulk_create_videos` 로직을 참조하세요.
    - **흐름**: 요청 루프 -> `pool.begin()`(트랜잭션 시작) -> 로직 수행 -> `commit` -> 성공 리스트 추가 (실패 시 `rollback` -> 실패 리스트 추가).

2.  **데이터 및 DTO 설계**:
    - **`StudyBulkCreateReq`**: `items` 필드에 `Vec<StudyCreateReq>`를 담아 요청받습니다.
    - **`StudyBulkCreateRes`**:
        - `success_count`: 성공 개수 (i64).
        - `failure_count`: 실패 개수 (i64).
        - `results`: 결과 리스트 `Vec<StudyBulkResult>` (id, idx, success 여부, error 메시지 포함).

3.  **상세 로직 흐름 (Service)**:
    - 1) **전체 감사 로그**: 시작 시 `user::repo::create_audit_log` 호출 (Action: "BULK_CREATE_STUDIES").
    - 2) **반복 처리 (Loop)**:
        - 각 아이템별로 트랜잭션을 시작합니다.
        - `study_idx` 중복을 체크합니다 (이미 존재하면 에러).
        - `repo::admin_create_study`를 호출해 데이터를 생성합니다.
        - **개별 로그**: 성공 시 `repo::create_study_log`를 호출해 `ADMIN_STUDY_LOG`에 기록합니다 (Action: `CREATE_STUDY`).
        - 트랜잭션을 커밋합니다.
    - 3) **결과 반환**: 실패가 하나라도 있으면 `207 Multi-Status`, 모두 성공하면 `201 Created`.

4.  **타입 및 안전성**:
    - **IpAddr**: 서비스 레이어에서 `String`을 `IpAddr`로 변환하여 로그 함수에 전달하는 로직을 유지하세요 (Phase 6-15와 동일).

IMPLEMENTATION STEPS:

1.  **DTO (`src/api/admin/study/dto.rs`)**:
    - `StudyBulkCreateReq`, `StudyBulkCreateRes`, `StudyBulkResult` 구조체 정의.

2.  **Service (`src/api/admin/study/service.rs`)**:
    - `admin_bulk_create_studies` 함수 구현.
    - 루프와 트랜잭션을 이용한 부분 성공 로직 구현.

3.  **Handler (`src/api/admin/study/handler.rs`)**:
    - 핸들러 구현 (201 또는 207 상태 코드 분기 처리).

4.  **Router & Docs**:
    - 라우터 등록 및 OpenAPI 문서 업데이트.

FILE PATCHES START
// src/api/admin/study/dto.rs
// src/api/admin/study/service.rs
// src/api/admin/study/handler.rs
// src/api/admin/study/router.rs
// src/docs.rs
FILE PATCHES END