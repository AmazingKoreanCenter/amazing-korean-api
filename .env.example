# ============================================================
# Amazing Korean API — 환경변수 (.env.example)
# SSoT: src/config.rs
# ============================================================

# --- DB / 서버 ---
DATABASE_URL=postgres://postgres:postgres@127.0.0.1:5432/amazing_korean_db
BIND_ADDR=0.0.0.0:3000
ENABLE_DOCS=1
SKIP_DB=1

# --- Redis ---
REDIS_PASSWORD=redis_dev_password
REDIS_URL=redis://:redis_dev_password@127.0.0.1:16379

# --- JWT ---
# JWT_SECRET: 최소 32바이트 필수 (HS256)
JWT_SECRET=change-me-this-must-be-at-least-32-bytes-for-security
JWT_EXPIRE_HOURS=24
JWT_ACCESS_TTL_MIN=15

# --- Refresh Token ---
REFRESH_TTL_DAYS=30
REFRESH_TTL_DAYS_ADMIN=7
REFRESH_TTL_DAYS_HYMN=1
REFRESH_COOKIE_NAME=ak_refresh
REFRESH_COOKIE_DOMAIN=
REFRESH_COOKIE_SECURE=false
REFRESH_COOKIE_SAMESITE=Lax

# --- Rate Limiting ---
# 로그인
RATE_LIMIT_LOGIN_WINDOW_SEC=900
RATE_LIMIT_LOGIN_MAX=10
# 학습 답안 제출
RATE_LIMIT_STUDY_WINDOW_SEC=60
RATE_LIMIT_STUDY_MAX=30
# 이메일 발송 (인증코드 등)
RATE_LIMIT_EMAIL_WINDOW_SEC=18000
RATE_LIMIT_EMAIL_MAX=5
# MFA 코드 검증
RATE_LIMIT_MFA_MAX=5
RATE_LIMIT_MFA_WINDOW_SEC=300

# --- CORS ---
# 쉼표로 구분 (예: http://localhost:5173,https://amazingkorean.net)
CORS_ORIGINS=http://localhost:5173

# --- OAuth 콜백 후 프론트엔드 리다이렉트 URL ---
FRONTEND_URL=http://localhost:5173

# --- Admin IP Allowlist ---
# 쉼표로 구분, 비어있으면 모든 IP 허용
# 예: 127.0.0.1,192.168.1.0/24,10.0.0.0/8
ADMIN_IP_ALLOWLIST=

# --- Google OAuth (소셜 로그인) ---
# Google Cloud Console에서 발급: https://console.cloud.google.com/apis/credentials
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GOOGLE_REDIRECT_URI=http://localhost:3000/auth/google/callback
OAUTH_STATE_TTL_SEC=300

# --- 이메일 ---
# EMAIL_PROVIDER: "resend" | "none"
# production에서 "none"이면 서버 부팅 실패 (panic)
EMAIL_PROVIDER=none
RESEND_API_KEY=
EMAIL_FROM_ADDRESS=noreply@amazingkorean.net

# --- 인증코드 / 비밀번호 재설정 TTL ---
VERIFICATION_CODE_TTL_SEC=600
RESET_TOKEN_TTL_SEC=1800

# --- MFA (Multi-Factor Authentication) ---
MFA_TOKEN_TTL_SEC=300

# --- Vimeo ---
VIMEO_ACCESS_TOKEN=

# --- Google Cloud Translation API ---
# TRANSLATE_PROVIDER: "google" | "none"
TRANSLATE_PROVIDER=none
GOOGLE_TRANSLATE_API_KEY=
GOOGLE_TRANSLATE_PROJECT_ID=

# --- 결제 (Paddle Billing) ---
# PAYMENT_PROVIDER: "paddle" | "none"
PAYMENT_PROVIDER=none
PADDLE_API_KEY=
PADDLE_CLIENT_TOKEN=
PADDLE_WEBHOOK_SECRET=
PADDLE_SANDBOX=true
PADDLE_PRODUCT_ID=
PADDLE_PRICE_MONTH_1=
PADDLE_PRICE_MONTH_3=
PADDLE_PRICE_MONTH_6=
PADDLE_PRICE_MONTH_12=

# --- Field Encryption (AES-256-GCM + HMAC-SHA256 Blind Index) ---
# 키 생성: openssl rand -base64 32
APP_ENV=development

# 암호화 키 (버전별 관리, 최소 1개 필수)
# ENCRYPTION_KEY_V1: 초기 키 (또는 레거시 ENCRYPTION_KEY → v1 자동 매핑)
# ENCRYPTION_KEY_V2: 로테이션 시 추가
# ENCRYPTION_CURRENT_VERSION: 신규 암호화에 사용할 버전 (기본 1)
ENCRYPTION_KEY_V1=
# ENCRYPTION_KEY_V2=
ENCRYPTION_CURRENT_VERSION=1

# HMAC 키 (blind index용, 필수, 로테이션 안 함)
HMAC_KEY=
